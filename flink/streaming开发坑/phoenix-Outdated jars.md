
2020-09-02 10:50:32,791 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - LookupJoin(table=[default_catalog.default_database.user_phoenix], joinType=[InnerJoin], async=[false], lookup=[uid1=uid], select=[uid, uid1, age1, created_time1]) (2/4) (24df1507ae311aa9efe5509de8262111) switched from RUNNING to FAILED.
java.lang.IllegalArgumentException: open() failed.
	at org.apache.flink.connector.jdbc.table.JdbcRowDataLookupFunction.open(JdbcRowDataLookupFunction.java:126) ~[flink-connector-jdbc_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at LookupFunction$21.open(Unknown Source) ~[?:?]
	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:36) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.table.runtime.operators.join.lookup.LookupJoinRunner.open(LookupJoinRunner.java:68) ~[flink-table-blink_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.table.runtime.operators.join.lookup.LookupJoinWithCalcRunner.open(LookupJoinWithCalcRunner.java:53) ~[flink-table-blink_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:36) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:102) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.api.operators.ProcessOperator.open(ProcessOperator.java:56) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.runtime.tasks.OperatorChain.initializeStateAndOpenOperators(OperatorChain.java:291) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$beforeInvoke$0(StreamTask.java:473) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.runThrowing(StreamTaskActionExecutor.java:47) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.beforeInvoke(StreamTask.java:469) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:522) ~[flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:721) [flink-dist_2.11-1.11.1.jar:1.11.1]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:546) [flink-dist_2.11-1.11.1.jar:1.11.1]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]
Caused by: java.sql.SQLException: ERROR 2007 (INT09): Outdated jars. Newer Phoenix clients can't communicate with older Phoenix servers. Client version: 5.1.0; Server version: 5.0.0 The following servers require an updated phoenix-[version]-server.jar to be put in the classpath of HBase: region=SYSTEM:CATALOG,,1596202048468.193d400918720abe86a0284ea10cdb76., hostname=qile-test-cdh003,16020,1598493395410, seqNum=931
	at org.apache.phoenix.exception.SQLExceptionCode$Factory$1.newException(SQLExceptionCode.java:568) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.exception.SQLExceptionInfo.buildException(SQLExceptionInfo.java:195) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl.checkClientServerCompatibility(ConnectionQueryServicesImpl.java:1582) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl.ensureTableCreated(ConnectionQueryServicesImpl.java:1379) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl.createTable(ConnectionQueryServicesImpl.java:1801) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.schema.MetaDataClient.createTableInternal(MetaDataClient.java:3007) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.schema.MetaDataClient.createTable(MetaDataClient.java:1104) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.compile.CreateTableCompiler$CreateTableMutationPlan.execute(CreateTableCompiler.java:383) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixStatement$2.call(PhoenixStatement.java:418) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixStatement$2.call(PhoenixStatement.java:400) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.call.CallRunner.run(CallRunner.java:53) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixStatement.executeMutation(PhoenixStatement.java:399) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixStatement.executeMutation(PhoenixStatement.java:387) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixStatement.executeUpdate(PhoenixStatement.java:1909) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl$13.call(ConnectionQueryServicesImpl.java:3169) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl$13.call(ConnectionQueryServicesImpl.java:3132) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.util.PhoenixContextExecutor.call(PhoenixContextExecutor.java:76) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.query.ConnectionQueryServicesImpl.init(ConnectionQueryServicesImpl.java:3132) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixDriver.getConnectionQueryServices(PhoenixDriver.java:255) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixEmbeddedDriver.createConnection(PhoenixEmbeddedDriver.java:144) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at org.apache.phoenix.jdbc.PhoenixDriver.connect(PhoenixDriver.java:221) ~[phoenix-client-5.0.0-SNAPSHOT.jar:5.0.0-SNAPSHOT]
	at java.sql.DriverManager.getConnection(DriverManager.java:664) ~[?:1.8.0_161]
	at java.sql.DriverManager.getConnection(DriverManager.java:270) ~[?:1.8.0_161]
	at org.apache.flink.connector.jdbc.table.JdbcRowDataLookupFunction.establishConnectionAndStatement(JdbcRowDataLookupFunction.java:198) ~[flink-connector-jdbc_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.connector.jdbc.table.JdbcRowDataLookupFunction.open(JdbcRowDataLookupFunction.java:120) ~[flink-connector-jdbc_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	... 15 more