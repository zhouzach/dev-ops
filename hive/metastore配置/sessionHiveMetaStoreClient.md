
org.apache.spark.sql.AnalysisException: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient;
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:108)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:216)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:114)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:102)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.internal.SharedState.globalTempViewManager$lzycompute(SharedState.scala:141)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.internal.SharedState.globalTempViewManager(SharedState.scala:136)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveSessionStateBuilder$$anonfun$2.apply(HiveSessionStateBuilder.scala:55)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveSessionStateBuilder$$anonfun$2.apply(HiveSessionStateBuilder.scala:55)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.catalog.SessionCatalog.globalTempViewManager$lzycompute(SessionCatalog.scala:91)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.catalog.SessionCatalog.globalTempViewManager(SessionCatalog.scala:91)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.catalog.SessionCatalog.isTemporaryTable(SessionCatalog.scala:731)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.isRunningDirectlyOnFiles(Analyzer.scala:749)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.resolveRelation(Analyzer.scala:683)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:715)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:708)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:89)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:708)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:654)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.immutable.List.foldLeft(List.scala:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:76)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.immutable.List.foreach(List.scala:392)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:76)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:127)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$$anonfun$apply$1$$anonfun$applyOrElse$15.apply(Analyzer.scala:214)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$$anonfun$apply$1$$anonfun$applyOrElse$15.apply(Analyzer.scala:212)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.IndexedSeqOptimized$class.foldl(IndexedSeqOptimized.scala:57)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.IndexedSeqOptimized$class.foldLeft(IndexedSeqOptimized.scala:66)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.mutable.ArrayBuffer.foldLeft(ArrayBuffer.scala:48)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$$anonfun$apply$1.applyOrElse(Analyzer.scala:212)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$$anonfun$apply$1.applyOrElse(Analyzer.scala:210)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:89)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$.apply(Analyzer.scala:210)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$CTESubstitution$.apply(Analyzer.scala:209)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:87)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.IndexedSeqOptimized$class.foldl(IndexedSeqOptimized.scala:57)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.IndexedSeqOptimized$class.foldLeft(IndexedSeqOptimized.scala:66)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.mutable.WrappedArray.foldLeft(WrappedArray.scala:35)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:76)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.collection.immutable.List.foreach(List.scala:392)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:76)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:127)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:121)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:106)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:105)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:201)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:105)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:57)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:55)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:47)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:78)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:651)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.ArgsHelper$.write2jdbc(ArgsHelper.scala:137)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.ArgsHelper$$anonfun$1.apply$mcV$sp(ArgsHelper.scala:95)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.ArgsHelper$$anonfun$1.apply(ArgsHelper.scala:34)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.ArgsHelper$$anonfun$1.apply(ArgsHelper.scala:34)
24-07-2020 13:51:07 CST report_timing INFO - 	at scala.util.Try$.apply(Try.scala:192)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.ArgsHelper$.handle(ArgsHelper.scala:34)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.Main$.main(Main.scala:25)
24-07-2020 13:51:07 CST report_timing INFO - 	at cn.ibobei.qile.datawarehouse.Main.main(Main.scala)
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
24-07-2020 13:51:07 CST report_timing INFO - 	at java.lang.reflect.Method.invoke(Method.java:498)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:851)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:167)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:195)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:926)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:935)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
24-07-2020 13:51:07 CST report_timing INFO - Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:242)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:394)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:338)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:318)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:294)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl.org$apache$spark$sql$hive$client$HiveClientImpl$$client(HiveClientImpl.scala:254)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl$$anonfun$withHiveState$1.apply(HiveClientImpl.scala:276)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl.liftedTree1$1(HiveClientImpl.scala:221)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl.retryLocked(HiveClientImpl.scala:220)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl.withHiveState(HiveClientImpl.scala:266)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.HiveClientImpl.databaseExists(HiveClientImpl.scala:356)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:217)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:217)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:217)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:99)
24-07-2020 13:51:07 CST report_timing INFO - 	... 120 more
24-07-2020 13:51:07 CST report_timing INFO - Caused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1775)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:80)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:130)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:101)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3819)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3871)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3851)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:4105)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:254)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:237)
24-07-2020 13:51:07 CST report_timing INFO - 	... 134 more
24-07-2020 13:51:07 CST report_timing INFO - Caused by: java.lang.reflect.InvocationTargetException
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
24-07-2020 13:51:07 CST report_timing INFO - 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
24-07-2020 13:51:07 CST report_timing INFO - 	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1773)
24-07-2020 13:51:07 CST report_timing INFO - 	... 143 more
24-07-2020 13:51:07 CST report_timing INFO - Caused by: java.lang.NoClassDefFoundError: org/apache/commons/dbcp/ConnectionFactory
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.datasource.DataSourceProviderFactory.<clinit>(DataSourceProviderFactory.java:30)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:607)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:655)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:419)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:356)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:317)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:688)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:654)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:648)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:717)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:420)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:78)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:84)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:7036)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:254)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)
24-07-2020 13:51:07 CST report_timing INFO - 	... 148 more
24-07-2020 13:51:07 CST report_timing INFO - Caused by: java.lang.ClassNotFoundException: org.apache.commons.dbcp.ConnectionFactory
24-07-2020 13:51:07 CST report_timing INFO - 	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
24-07-2020 13:51:07 CST report_timing INFO - 	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.IsolatedClientLoader$$anon$1.doLoadClass(IsolatedClientLoader.scala:246)
24-07-2020 13:51:07 CST report_timing INFO - 	at org.apache.spark.sql.hive.client.IsolatedClientLoader$$anon$1.loadClass(IsolatedClientLoader.scala:235)
24-07-2020 13:51:07 CST report_timing INFO - 	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)


在/opt/cloudera/parcels/CDH/lib/hive/lib/是存在ommons-dbcp-1.4.jar，
根本原因是Hive Gateway所在节点没有部署Spark Gateway角色，在spark任务读取hive table时，就会报错